/*
 * Game: Flappy Bird
 * The author:syw
 *--my first game by independent programming---------
 *
 * P4.1 --> SCL
 * P4.2 --> SDA
 * 3.3V --> VDD
 * GND  --> VSS
 * Press P2.1 to operate
 *
 * 2021/3/24 started the project
 * 2021/3/24 The game worked
 * 2021/3/25 optimized the game
 * 2021/3/26 added comments in program
 *
 */

#include "driverlib.h"
#include "iic.h"
#include "MSP430.h"
#include "my_game.h"
#include <stdio.h>
#include <stdlib.h>

//image of the game. it is used to be printed
uint8_t game_image[142][8]={0};

//image of game start part1
uint8_t image_start_up[128][4]={
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",0*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",1*/

                                {0x40,0x00,0x00,0x08},
                                {0xC0,0xFF,0xFF,0x0F},
                                {0x40,0x00,0x01,0x0C},
                                {0x40,0x00,0x01,0x00},
                                {0x40,0x00,0x01,0x00},
                                {0x40,0xC0,0x07,0x00},
                                {0xC0,0x01,0x00,0x00},
                                {0x00,0x06,0x00,0x00},/*"F",2*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x40,0x00,0x00,0x08},
                                {0xC0,0xFF,0xFF,0x0F},
                                {0x00,0x00,0x00,0x0C},
                                {0x00,0x00,0x00,0x08},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*"l",3*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x80,0xE3,0x07},
                                {0x00,0x40,0x10,0x0C},
                                {0x00,0x20,0x08,0x08},
                                {0x00,0x20,0x08,0x04},
                                {0x00,0xC0,0xFF,0x03},
                                {0x00,0x00,0x00,0x04},
                                {0x00,0x00,0x00,0x03},/*"a",4*/

                                {0x00,0x00,0x00,0x80},
                                {0x00,0xC0,0xFF,0xFF},
                                {0x00,0x80,0x00,0x86},
                                {0x00,0x40,0x00,0x08},
                                {0x00,0x20,0x00,0x08},
                                {0x00,0x40,0x00,0x06},
                                {0x00,0x80,0xFF,0x01},
                                {0x00,0x00,0x00,0x00},/*"p",5*/

                                {0x00,0x00,0x00,0x80},
                                {0x00,0xC0,0xFF,0xFF},
                                {0x00,0x80,0x00,0x86},
                                {0x00,0x40,0x00,0x08},
                                {0x00,0x20,0x00,0x08},
                                {0x00,0x40,0x00,0x06},
                                {0x00,0x80,0xFF,0x01},
                                {0x00,0x00,0x00,0x00},/*"p",6*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x60,0x00,0xC0},
                                {0x00,0xE0,0x0F,0xC0},
                                {0x00,0x00,0xF0,0x39},
                                {0x00,0x00,0xE0,0x07},
                                {0x00,0xA0,0x1F,0x00},
                                {0x00,0x60,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*"y",7*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",8*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",9*/

                                {0x40,0x00,0x00,0x08},
                                {0xC0,0xFF,0xFF,0x0F},
                                {0x40,0x00,0x01,0x08},
                                {0x40,0x00,0x01,0x08},
                                {0x40,0x80,0x01,0x08},
                                {0x80,0x40,0x01,0x04},
                                {0x00,0x3F,0xFE,0x03},
                                {0x00,0x00,0x00,0x00},/*"B",10*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x20,0x00,0x08},
                                {0xC0,0xE1,0xFF,0x0F},
                                {0xC0,0x01,0x00,0x0C},
                                {0x00,0x00,0x00,0x08},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*"i",11*/

                                {0x00,0x00,0x00,0x08},
                                {0x00,0x20,0x00,0x08},
                                {0x00,0xE0,0xFF,0x0F},
                                {0x00,0x00,0x03,0x08},
                                {0x00,0xC0,0x00,0x08},
                                {0x00,0x20,0x00,0x00},
                                {0x00,0xE0,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*"r",12*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0xFF,0x01},
                                {0x00,0xC0,0x00,0x06},
                                {0x00,0x20,0x00,0x08},
                                {0x00,0x40,0x00,0x04},
                                {0x40,0x80,0x00,0x03},
                                {0xE0,0xFF,0xFF,0x07},
                                {0x00,0x00,0x00,0x04},/*"d",13*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",14*/

                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},
                                {0x00,0x00,0x00,0x00},/*" ",15*/
};

//image of game start part2
uint8_t image_start_down[128][4]={
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x60},
                                  {0x00,0x00,0x00,0x70},
                                  {0x00,0x00,0x00,0x38},
                                  {0x00,0x00,0x00,0x0E},
                                  {0x00,0xF0,0x7F,0x00},
                                  {0x00,0xE0,0x7F,0x00},
                                  {0x00,0x20,0x10,0x00},
                                  {0x00,0x20,0x10,0x00},
                                  {0x00,0x20,0x10,0x01},
                                  {0x00,0x20,0x10,0x0E},
                                  {0x00,0x20,0x10,0x7C},
                                  {0x00,0x20,0x10,0x10},
                                  {0xFC,0x3F,0x10,0x00},
                                  {0xF8,0x3F,0x10,0x00},
                                  {0x80,0x20,0x10,0x00},
                                  {0x80,0x20,0x10,0x03},
                                  {0x80,0x20,0x10,0x1E},
                                  {0x80,0x20,0x10,0x3C},
                                  {0x80,0x20,0x10,0x00},
                                  {0x80,0x20,0x10,0x00},
                                  {0x80,0xE0,0x7F,0x00},
                                  {0x80,0xF0,0x3F,0x00},
                                  {0xC0,0x20,0x00,0x03},
                                  {0xC0,0x00,0x00,0x0E},
                                  {0x80,0x00,0x00,0x7C},
                                  {0x00,0x00,0x00,0x38},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},/*"µã",0*/

                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x80,0x00,0x00},
                                  {0x00,0x80,0x00,0x00},
                                  {0x00,0x80,0x00,0x00},
                                  {0x00,0x81,0x00,0x00},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0xFC,0x1F},
                                  {0x00,0x81,0xF8,0x0F},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0xFC,0xFF,0xFF,0x0F},
                                  {0xF8,0xFF,0xFF,0x0F},
                                  {0x08,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0x00,0x08},
                                  {0x00,0x81,0xFC,0x7F},
                                  {0x80,0x81,0xFC,0x3F},
                                  {0x80,0x81,0x08,0x00},
                                  {0x00,0xC1,0x00,0x00},
                                  {0x00,0xC0,0x00,0x00},
                                  {0x00,0x80,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},/*"»÷",1*/

                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x80,0x00,0x40},
                                  {0x20,0x80,0x00,0x20},
                                  {0x20,0x80,0x00,0x20},
                                  {0x20,0x80,0x00,0x10},
                                  {0x20,0x80,0x00,0x08},
                                  {0x20,0x80,0x00,0x04},
                                  {0x20,0x80,0x00,0x03},
                                  {0x20,0x80,0xC0,0x01},
                                  {0xE0,0xFF,0xFF,0x00},
                                  {0xE0,0xFF,0x1F,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0xE0,0xFF,0xFF,0x7F},
                                  {0xE0,0xFF,0xFF,0x3F},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x20,0x80,0x00,0x00},
                                  {0x30,0x80,0x00,0x00},
                                  {0x38,0x80,0x00,0x00},
                                  {0x30,0xC0,0x00,0x00},
                                  {0x20,0xC0,0x00,0x00},
                                  {0x00,0x80,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},/*"¿ª",2*/

                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x04,0x00,0x40},
                                  {0x00,0x04,0x18,0x20},
                                  {0x00,0x04,0x3F,0x10},
                                  {0x00,0xF4,0x23,0x18},
                                  {0x80,0x3F,0x40,0x0C},
                                  {0xFC,0x07,0x40,0x06},
                                  {0x78,0x04,0x80,0x03},
                                  {0x08,0x04,0xF0,0x00},
                                  {0x00,0x04,0xBE,0x01},
                                  {0x00,0xF4,0x07,0x03},
                                  {0x00,0xFE,0x00,0x07},
                                  {0x00,0x04,0x00,0x06},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x70,0x00,0x00},
                                  {0x00,0x78,0xFE,0x7F},
                                  {0x00,0x26,0xFC,0x3F},
                                  {0x80,0x23,0x04,0x08},
                                  {0xF0,0x20,0x04,0x08},
                                  {0x3C,0x20,0x04,0x08},
                                  {0x18,0x20,0x04,0x08},
                                  {0x08,0x20,0x04,0x08},
                                  {0x00,0x10,0x04,0x08},
                                  {0x00,0x11,0x04,0x08},
                                  {0x00,0x13,0x04,0x08},
                                  {0x00,0x16,0xFC,0x3F},
                                  {0x00,0x1C,0xFE,0x3F},
                                  {0x00,0x7C,0x04,0x00},
                                  {0x00,0x38,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},
                                  {0x00,0x00,0x00,0x00},/*"Ê¼",3*/
};

//image of game over part1
uint8_t image_over_up[128][4]={
                               {0x00,0x00,0x00,0x00},
                               {0x00,0xE0,0x1F,0x00},
                               {0x00,0xFC,0xFF,0x00},
                               {0x00,0x0E,0xC0,0x03},
                               {0x80,0x03,0x00,0x06},
                               {0x80,0x00,0x00,0x0C},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x04,0x08},
                               {0x80,0x00,0x04,0x04},
                               {0x80,0x03,0xFC,0x03},
                               {0x00,0x0E,0xFC,0x03},
                               {0x00,0x00,0x04,0x00},
                               {0x00,0x00,0x04,0x00},
                               {0x00,0x00,0x00,0x00},/*"G",0*/

                               {0x00,0x00,0x00,0x08},
                               {0x00,0x00,0x00,0x0C},
                               {0x00,0x00,0x80,0x0F},
                               {0x00,0x00,0x7C,0x08},
                               {0x00,0xC0,0x0F,0x08},
                               {0x00,0x7C,0x08,0x00},
                               {0xC0,0x03,0x08,0x00},
                               {0xC0,0x03,0x08,0x00},
                               {0xC0,0x3F,0x08,0x00},
                               {0x00,0xFC,0x0B,0x00},
                               {0x00,0x80,0x7F,0x08},
                               {0x00,0x00,0xF8,0x0F},
                               {0x00,0x00,0x80,0x0F},
                               {0x00,0x00,0x00,0x0C},
                               {0x00,0x00,0x00,0x08},
                               {0x00,0x00,0x00,0x00},/*"A",1*/

                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0xC0,0x0F,0x00,0x08},
                               {0x80,0xFF,0x01,0x00},
                               {0x00,0xF0,0x1F,0x00},
                               {0x00,0x00,0xFE,0x03},
                               {0x00,0x00,0xC0,0x0F},
                               {0x00,0x00,0xF0,0x00},
                               {0x00,0x80,0x0F,0x00},
                               {0x00,0x78,0x00,0x08},
                               {0x80,0x07,0x00,0x08},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},/*"M",2*/

                               {0x00,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x80,0x03,0x08},
                               {0x40,0xE0,0x0F,0x08},
                               {0xC0,0x00,0x00,0x0C},
                               {0xC0,0x01,0x00,0x0E},
                               {0x00,0x06,0x80,0x01},
                               {0x00,0x00,0x00,0x00},/*"E",3*/

                               {0x00,0x00,0x00,0x00},
                               {0x00,0xF0,0x1F,0x00},
                               {0x00,0xFC,0xFF,0x00},
                               {0x00,0x0F,0xC0,0x03},
                               {0x80,0x01,0x00,0x06},
                               {0x80,0x00,0x00,0x04},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0x80,0x00,0x00,0x04},
                               {0x80,0x01,0x00,0x06},
                               {0x00,0x0F,0xC0,0x03},
                               {0x00,0xFC,0xFF,0x00},
                               {0x00,0xE0,0x3F,0x00},
                               {0x00,0x00,0x00,0x00},/*"O",4*/

                               {0x00,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x00},
                               {0xC0,0x07,0x00,0x00},
                               {0xC0,0xFF,0x00,0x00},
                               {0x40,0xF8,0x0F,0x00},
                               {0x00,0x00,0xFF,0x00},
                               {0x00,0x00,0xF0,0x0F},
                               {0x00,0x00,0x80,0x03},
                               {0x00,0x00,0x78,0x00},
                               {0x00,0x80,0x07,0x00},
                               {0x40,0x78,0x00,0x00},
                               {0xC0,0x07,0x00,0x00},
                               {0xC0,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x00},
                               {0x00,0x00,0x00,0x00},/*"V",5*/

                               {0x00,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x80,0x03,0x08},
                               {0x40,0xE0,0x0F,0x08},
                               {0xC0,0x00,0x00,0x0C},
                               {0xC0,0x01,0x00,0x0E},
                               {0x00,0x06,0x80,0x01},
                               {0x00,0x00,0x00,0x00},/*"E",6*/

                               {0x00,0x00,0x00,0x00},
                               {0x40,0x00,0x00,0x08},
                               {0x40,0x00,0x00,0x08},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0xC0,0xFF,0xFF,0x0F},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x08},
                               {0x40,0x00,0x01,0x00},
                               {0x40,0x00,0x07,0x00},
                               {0x40,0x00,0x3F,0x00},
                               {0xC0,0x80,0xF9,0x01},
                               {0x80,0xC1,0xC0,0x0F},
                               {0x80,0x7F,0x00,0x0E},
                               {0x00,0x3E,0x00,0x08},
                               {0x00,0x00,0x00,0x08},
                               {0x00,0x00,0x00,0x00},/*"R",7*/
};

////image of game over part2
uint8_t image_over_down[128][4]={{0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x04,0x08,0x00},
                                 {0x00,0x04,0x04,0x00},
                                 {0x00,0x02,0x02,0x00},
                                 {0x80,0x01,0x01,0x00},
                                 {0xC0,0xC0,0x00,0x40},
                                 {0x60,0xE0,0xFF,0x3F},
                                 {0x30,0x30,0x00,0x00},
                                 {0x3C,0x1C,0x00,0x00},
                                 {0x18,0x0F,0x10,0x00},
                                 {0x00,0x06,0x10,0x00},
                                 {0x00,0x02,0x11,0x00},
                                 {0x00,0x00,0x11,0x00},
                                 {0xF0,0x3F,0x31,0x00},
                                 {0xF0,0x3F,0xD1,0x00},
                                 {0x10,0x11,0x91,0x03},
                                 {0x10,0x11,0x11,0x07},
                                 {0x10,0x11,0x11,0x00},
                                 {0x10,0x11,0x11,0x10},
                                 {0x10,0x11,0x11,0x10},
                                 {0x10,0x11,0x11,0x30},
                                 {0x10,0x11,0x11,0x70},
                                 {0x10,0x11,0xFF,0x3F},
                                 {0x10,0x11,0xFF,0x3F},
                                 {0xF8,0x3F,0x11,0x00},
                                 {0xF0,0x3F,0x11,0x00},
                                 {0x00,0x80,0x11,0x00},
                                 {0x00,0x00,0x19,0x00},
                                 {0x00,0x00,0x10,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"µÃ",0*/

                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x02,0x00},
                                 {0x00,0x00,0x01,0x40},
                                 {0x00,0x80,0x00,0x40},
                                 {0x00,0x40,0x00,0x20},
                                 {0x00,0x30,0x00,0x10},
                                 {0x00,0x58,0x00,0x18},
                                 {0x00,0x4E,0x00,0x0C},
                                 {0x00,0x47,0x00,0x06},
                                 {0xC0,0x41,0x00,0x03},
                                 {0xF8,0x40,0xE0,0x01},
                                 {0x38,0x40,0x7C,0x00},
                                 {0x10,0xC0,0x1F,0x00},
                                 {0x00,0xC0,0x01,0x00},
                                 {0x00,0x40,0x00,0x08},
                                 {0x00,0x40,0x00,0x10},
                                 {0x00,0x40,0x00,0x10},
                                 {0x0C,0x40,0x00,0x70},
                                 {0x78,0x40,0x00,0x30},
                                 {0xC0,0x41,0x00,0x3C},
                                 {0x00,0xC7,0xFF,0x1F},
                                 {0x00,0xEC,0xFF,0x01},
                                 {0x00,0x58,0x00,0x00},
                                 {0x00,0x30,0x00,0x00},
                                 {0x00,0x60,0x00,0x00},
                                 {0x00,0xE0,0x00,0x00},
                                 {0x00,0xC0,0x00,0x00},
                                 {0x00,0xC0,0x00,0x00},
                                 {0x00,0x40,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"·Ö",1*/

                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0xC0,0x00,0x06},
                                 {0x00,0xE0,0x01,0x0F},
                                 {0x00,0xE0,0x01,0x0F},
                                 {0x00,0xC0,0x00,0x06},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*":",2*/

                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*" ",3*/

                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*" ",4*/

                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*" ",5*/
};

//the image of nnumber
uint8_t image_number[11][16][4]={
                                {{0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0xF0,0x3F,0x00},
                                 {0x00,0xFE,0xFF,0x01},
                                 {0x00,0x0F,0xC0,0x03},
                                 {0x80,0x01,0x00,0x06},
                                 {0xC0,0x00,0x00,0x0C},
                                 {0x40,0x00,0x00,0x08},
                                 {0x40,0x00,0x00,0x08},
                                 {0x40,0x00,0x00,0x08},
                                 {0x80,0x01,0x00,0x06},
                                 {0x00,0x07,0x80,0x03},
                                 {0x00,0xFE,0xFF,0x01},
                                 {0x00,0xF0,0x3F,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"0",0*/},

                                {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x01,0x00,0x08},
                                 {0x00,0x01,0x00,0x08},
                                 {0x00,0x01,0x00,0x08},
                                 {0x00,0x01,0x00,0x0C},
                                 {0x80,0xFF,0xFF,0x0F},
                                 {0xC0,0xFF,0xFF,0x0F},
                                 {0x00,0x00,0x00,0x0C},
                                 {0x00,0x00,0x00,0x08},
                                 {0x00,0x00,0x00,0x08},
                                 {0x00,0x00,0x00,0x08},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"1",1*/},
                                {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x1E,0x00,0x0E},
                                 {0x00,0x19,0x00,0x0D},
                                 {0x80,0x00,0x80,0x0C},
                                 {0x40,0x00,0x40,0x0C},
                                 {0x40,0x00,0x30,0x0C},
                                 {0x40,0x00,0x18,0x0C},
                                 {0x40,0x00,0x0C,0x0C},
                                 {0x40,0x00,0x06,0x0C},
                                 {0xC0,0x00,0x03,0x0C},
                                 {0x80,0xC1,0x01,0x0C},
                                 {0x80,0xFF,0x00,0x0E},
                                 {0x00,0x3E,0xC0,0x03},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"2",2*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x0F,0xC0,0x03},
                                 {0x80,0x0F,0xC0,0x07},
                                 {0x80,0x00,0x00,0x04},
                                 {0x40,0x00,0x00,0x08},
                                 {0x40,0x00,0x01,0x08},
                                 {0x40,0x00,0x01,0x08},
                                 {0x40,0x00,0x01,0x08},
                                 {0xC0,0x80,0x03,0x08},
                                 {0x80,0xC1,0x02,0x04},
                                 {0x00,0x7F,0x06,0x06},
                                 {0x00,0x3E,0xFC,0x03},
                                 {0x00,0x00,0xF0,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"3",3*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x30,0x00},
                                 {0x00,0x00,0x2C,0x00},
                                 {0x00,0x00,0x26,0x00},
                                 {0x00,0x80,0x21,0x00},
                                 {0x00,0x60,0x20,0x00},
                                 {0x00,0x10,0x20,0x08},
                                 {0x00,0x0C,0x20,0x08},
                                 {0x00,0x03,0x20,0x08},
                                 {0xC0,0xFF,0xFF,0x0F},
                                 {0xC0,0xFF,0xFF,0x0F},
                                 {0x00,0x00,0x20,0x08},
                                 {0x00,0x00,0x20,0x08},
                                 {0x00,0x00,0x20,0x08},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"4",4*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0xC0,0x03},
                                 {0x00,0xFF,0xC3,0x04},
                                 {0xC0,0x00,0x01,0x04},
                                 {0xC0,0x80,0x00,0x08},
                                 {0xC0,0x40,0x00,0x08},
                                 {0xC0,0x40,0x00,0x08},
                                 {0xC0,0x40,0x00,0x08},
                                 {0xC0,0x40,0x00,0x08},
                                 {0xC0,0xC0,0x00,0x04},
                                 {0xC0,0x80,0x01,0x07},
                                 {0xC0,0x00,0xFF,0x03},
                                 {0xC0,0x00,0xFC,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"5",5*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0xE0,0x7F,0x00},
                                 {0x00,0xFC,0xFF,0x01},
                                 {0x00,0x07,0x83,0x07},
                                 {0x80,0x81,0x00,0x06},
                                 {0x80,0xC0,0x00,0x0C},
                                 {0x40,0x40,0x00,0x08},
                                 {0x40,0x40,0x00,0x08},
                                 {0x40,0x40,0x00,0x08},
                                 {0x40,0xC0,0x00,0x0C},
                                 {0x80,0x83,0x01,0x06},
                                 {0x80,0x03,0xFF,0x03},
                                 {0x00,0x00,0xFC,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"6",6*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x0E,0x00,0x00},
                                 {0xC0,0x03,0x00,0x00},
                                 {0xC0,0x00,0x00,0x00},
                                 {0xC0,0x00,0x00,0x00},
                                 {0xC0,0x00,0xC0,0x0F},
                                 {0xC0,0x00,0xFC,0x0F},
                                 {0xC0,0x00,0x03,0x00},
                                 {0xC0,0xE0,0x00,0x00},
                                 {0xC0,0x18,0x00,0x00},
                                 {0xC0,0x06,0x00,0x00},
                                 {0xC0,0x01,0x00,0x00},
                                 {0xC0,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"7",7*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0xF0,0x01},
                                 {0x00,0x3E,0xFC,0x03},
                                 {0x00,0x7F,0x0E,0x06},
                                 {0x80,0xF1,0x02,0x04},
                                 {0xC0,0xC0,0x01,0x08},
                                 {0x40,0xC0,0x01,0x08},
                                 {0x40,0x80,0x01,0x08},
                                 {0x40,0x00,0x03,0x08},
                                 {0x40,0x00,0x07,0x08},
                                 {0xC0,0x80,0x0E,0x04},
                                 {0x80,0x41,0x1E,0x06},
                                 {0x00,0x7F,0xFC,0x03},
                                 {0x00,0x1E,0xF0,0x01},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"8",8*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0xFC,0x01,0x00},
                                 {0x00,0xFF,0x03,0x07},
                                 {0x80,0x03,0x07,0x07},
                                 {0x80,0x00,0x0C,0x08},
                                 {0x40,0x00,0x08,0x08},
                                 {0x40,0x00,0x08,0x08},
                                 {0x40,0x00,0x08,0x08},
                                 {0x40,0x00,0x08,0x0C},
                                 {0x40,0x00,0x04,0x06},
                                 {0x80,0x00,0x06,0x03},
                                 {0x00,0x03,0xE1,0x01},
                                 {0x00,0xFE,0x7F,0x00},
                                 {0x00,0xF8,0x1F,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*"9",9*/},
                                 {
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},
                                 {0x00,0x00,0x00,0x00},/*" ",10*/},
};

//the image of bird
uint8_t image_bird[7][1]={{0xBE},
                          {0xE3},
                          {0xC1},
                          {0xC9},
                          {0xCD},
                          {0xC1},
                          {0xBE},};

//the image to delete the image of bird
uint8_t image_void[7][1]={0};

//the image of dead bird. like that--> x
uint8_t image_bird_dead[7][1]={  {0xC1},
                                 {0xA2},
                                 {0x94},
                                 {0x88},
                                 {0x94},
                                 {0xA2},
                                 {0xC1},};

//the parameter of game
int16_t game_para[16]={0};

//y = -37.5*t+37.5*t, then delete some '0'
int16_t speed_table[60]={-1, -1, -1, -1, -1, -1, 0, -1, 0, -1, 0, -1,
                         0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0,
                         1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 1,
                         2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 3, 3,
                         2, 3, 3, 3, 3, 3, 3};

//binary table
uint8_t bit_table[8]={0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80};


/*
 * delay in ms
 */
void DelayMs(uint16_t x)
{
    uint16_t i, j;
    for(j=0;j<x; j++)
    {
        for(i=0; i<50; i++)
       {
            __delay_cycles(320);
       }
    }
}

/*
 * the game flappybird
 */
void FlappyBird()
{
    while(1)
    {
        GameInit();
        Game();
        DelayMs(300);
    }
}

/*
 * game initialization
 */
void GameInit()
{
    uint8_t i, j;

    for(i=0; i<8; i++)
    {
        for(j=0; j<142; j++)
        {
            game_image[j][i] = 0;                       //initialize game_image
        }
    }

    birdSpeedCount = 16;
    birdSpeed = speed_table[birdSpeedCount];             //initialize bird speed
    birdPositionV = 32;                                  //initialize bird position
    birdPositionH = 32;                                 //initialize bird position
    birdScore = 0;                                      //initialize score

    TwoLine(image_start_up, image_start_down);          //print the start image
    ScreenPrint(game_image);

    for(i=0; i<8; i++)                                  //clear the game image
        {
            for(j=0; j<142; j++)
            {
                game_image[j][i] = 0;
            }
        }

    //wait for signal
    while(1)
    {
        if(GetSignal())
        {
            return;
        }
    }

}

void Game()
{
    uint8_t deadFlag = 0;    //death flag
    uint8_t count = 12;      //count frames to add pillar
    uint8_t pillarCount = 0; //count frames to move image(i'm sorry for the name)

    ImageAddPillar(127);
    ImageAddPillar(81); //add initial pillars

    ImageAddBird(image_bird);
    ImageAddEdge();
    ScreenPrint(game_image);    //add bird and print the game image in screen

    ImageAddBird(image_void); //delete the bird in game image, which is convenient to estimation of death
    while(1)
        {
            if(GetSignal())
            {
                break;
            }
        }

        P2IES &= ~0x02;     //Set P2.1 interruption
        P2IFG &= ~0x02;
        P2IE |= 0x02;

    while(!deadFlag)
    {
        ImageAddBird(image_bird);
        ImageAddEdge();
        ScreenPrint(game_image);    //add bird and print the game image in screen
        ImageAddBird(image_void);   //delete the bird in game image, which is convenient to estimation of death

        birdSpeed = speed_table[birdSpeedCount]; //get speed form speed table
        birdPositionV += birdSpeed;              //renew the positon
        birdSpeedCount++;                        //the next frame get the next value from speed table

        pillarCount++;
        pillarCount %= 3;       //move the image every 3 frames

        if(!pillarCount)
        {
            count++;
            count %= 46;
            ImageMove(count);    //add the pillar every 46 frames
        }

        deadFlag = Dead();  //whether dead?
    }

    //unable interrupt
    P2IE &= ~0x02;

    //reload the edge
    ImageAddEdge();

    //the bird blink when it is dead
    uint8_t i;
    for(i=0; i<3; i++)
    {
        ImageAddBird(image_bird);
        ScreenPrint(game_image);
        DelayMs(100);

        ImageAddBird(image_bird_dead);
        ScreenPrint(game_image);
        DelayMs(100);
    }

    //hold on the picture of death
    while(1)
    {
        if(GetSignal())
        {
            break;
        }
    }
    GameOver();
}

/*
 * gameover function
 */
void GameOver()
{
    int16_t scoreNumber = 0;
    scoreNumber = (birdScore - 9)/46;
    ImageAddNumber(scoreNumber);
    TwoLine(image_over_up, image_over_down);
    ScreenPrint(game_image);
    ImageAddNumber(-1);

    DelayMs(100);
    //wait for signal
    while(1)
    {
        if(GetSignal())
        {
            return;
        }
    }
}

/*
 * move the game_image in 1 bit of every 3 frames and add new pillar
 */
void ImageMove(uint8_t count)
{
    uint8_t i, j;

    birdScore++;

    if(!count)
    {
        ImageAddPillar(141);
    }

    for(i=0; i<8; i++)
    {
        for(j=0; j<141; j++)
        {
            game_image[j][i] = game_image[j+1][i];
        }
    }

    for(i=0; i<8; i++)
    {
        game_image[141][i] = 0x0;
    }
}

/*
 * add pillar in game_image in the position you want
 */
void ImageAddPillar(uint8_t pillarPosition)
{
    uint8_t i, j;
    uint8_t min = pillarPosition-13;
    for(i=min; i<=pillarPosition; i++)
    {
        for(j=0; j<8; j++)
        {
            game_image[i][j] = 0xff;
        }
    }

    uint8_t vacant =rand()%32;

    for(i=min; i<=pillarPosition; i++)
    {
        for(j=vacant; j<=vacant+32; j++)
        {
            WriteImage(i, j, 0);
        }
    }
}

/*
 * draw the image you want in game_image
 */
void ImageGet(uint8_t image_want[][8])
{
    uint8_t i, j;
    for(i=0; i<8; i++)
    {
        for(j=0; j<128; j++)
        {
            game_image[j][i] = image_want[j][i];
        }
    }
}

/*
 * read one bit by it position in hexadecimal
 */
uint8_t ReadBit(uint8_t x, uint8_t xnumber)
{
    if((x>>xnumber) & 0x01)
    {
        return 0x01;
    }
    else
    {
        return 0x00;
    }
}

/*
 * write one bit by it position in hexadecimal
 */
void WriteBit(uint8_t* x, uint8_t xnumber, uint8_t want)
{
    if(want)
    {
        *x |= bit_table[xnumber];
    }
    else
    {
        *x &= ~(bit_table[xnumber]);
    }
}

/*
 * write one bit of the image by it coordinates
 */
void WriteImage(uint8_t horizontal, uint8_t vertical, uint8_t want)
{
    uint8_t vertical_there, vertical_mod;
    vertical_there = vertical>>3;
    vertical_mod = vertical & 0x07;
    WriteBit(&(game_image[horizontal][vertical_there]), vertical_mod, want);
}

/*
 * read one bit of the image by it coordinates
 */
uint8_t ReadImage(uint8_t horizontal, uint8_t vertical)
{
    if(ReadBit(game_image[horizontal][vertical/8], vertical%8))
        return 0x01;
    else
        return 0x00;
}

/*
 * add or delete the bird
 */
void ImageAddBird(uint8_t image_want[][1])
{
    uint8_t i, j;
    for(i=0; i<7; i++)
    {
        for(j=0; j<7; j++)
        {
            WriteImage(birdPositionH-i, birdPositionV+j, ReadBit(image_want[6-i][0], j));
        }
    }
}

/*
 * to estimate whether player is lost
 */
uint8_t Dead()
{
    uint8_t i, j;
    for(i=0; i<7; i++)
    {
        for(j=0; j<7; j++)
        {
            if(ReadBit(game_image[birdPositionH-i][(birdPositionV+j)/8], (birdPositionV+j)%8))
            return 1;
        }
    }
    return 0;
}

/*
 * to get signal from user, only used in waiting situation
 */
uint8_t GetSignal()
{
    if(!(GPIO_INPUT_PIN_HIGH == (GPIO_getInputPinValue(GPIO_PORT_P2, GPIO_PIN1))))
    {
        DelayMs(10);
        if (!(GPIO_INPUT_PIN_HIGH == (GPIO_getInputPinValue(GPIO_PORT_P2, GPIO_PIN1))))
        {
            DelayMs(10);
            return 1;
        }
    }
    return 0;
}

/*
 * add edge in bottom and top of screen
 */
void ImageAddEdge()
{
    uint8_t i;

    for(i=0; i<128; i++)
    {
        WriteImage(i,0,1);
        WriteImage(i,63,1);
    }
}

/*
 * write two lines in screen
 */
void TwoLine(uint8_t up[][4], uint8_t down[][4])
{
    uint8_t i, j;

    for(i=0; i<128; i++)
    {
        for(j=0; j<4; j++)
        {
            game_image[i][j] = up[i][j];
        }
        for(j=4; j<8; j++)
        {
            game_image[i][j] = down[i][j-4];
        }
    }
}
/*
 * add number in image
 * supported by the function: OverWriteNumber
 */
void ImageAddNumber(int16_t number)
{
    if(number==-1)
    {
        OverWriteNumber(10, 1);
        OverWriteNumber(10, 2);
    }
    else
    {
        int16_t i, j;
        i = (number%100)/10;
        j = number%10;
        OverWriteNumber(i, 1);
        OverWriteNumber(j, 2);
    }
}

/*
 * write the number you want in bottom right corner of the screen
 */
void OverWriteNumber(uint16_t number, uint8_t mod)
{
    uint8_t i, j;
    if(mod==1)                                  //write number in first position
    {
        if(number==0)
        {
            number = 10;                        //don't write '0' in first position
        }
        for(i=0; i<16; i++)
        {
            for(j=0; j<4; j++)
            {
                    image_over_down[i+96][j] = image_number[number][i][j];
            }
        }
    }
    else                                        //write number in last position
    {
        for(i=0; i<16; i++)
        {
            for(j=0; j<4; j++)
            {
                image_over_down[i+112][j] = image_number[number][i][j];
            }
        }
    }
}

void main (void)
{
    //stop watchdog timer
    WDT_A_hold(WDT_A_BASE);

    //set clock to 16MHz
    UCS_initFLLSettle(16000, 488);

    //set P4.1 and P4.2 to output direction
    P4DIR |= 0x06;

    //set P2.7 to input direction
    GPIO_setAsInputPin(
        GPIO_PORT_P2,
        GPIO_PIN1
        );
    GPIO_setAsInputPinWithPullUpResistor(GPIO_PORT_P2, GPIO_PIN1);

    //open INT
    __bis_SR_register(GIE);

    //initialize the screen
    Init();
    //begin the game;
    FlappyBird();
}

//use INT to scan the key
#pragma vector=PORT2_VECTOR
__interrupt void Port_2(void)
{
    birdSpeedCount = 0; //reset the bird speed
    DelayMs(10);
    P2IFG &= ~0x02; //clear interrupt flag
}






